# Public Client

A Public Client provides read-only access to the Ethereum blockchain through standard JSON-RPC methods like `eth_blockNumber`, `eth_getBalance`, `eth_call`, and more.

## Creating a Public Client

:::code-group

```go [Go]
import (
    "github.com/ChefBingbong/viem-go/client"
    "github.com/ChefBingbong/viem-go/client/transport"
    "github.com/ChefBingbong/viem-go/chain/definitions"
)

publicClient, err := client.CreatePublicClient(client.PublicClientConfig{
    Chain:     definitions.Mainnet,
    Transport: transport.HTTP("https://eth.llamarpc.com"),
})
if err != nil {
    log.Fatal(err)
}
defer publicClient.Close()
```

```typescript [TypeScript (viem)]
import { createPublicClient, http } from 'viem'
import { mainnet } from 'viem/chains'

const publicClient = createPublicClient({
  chain: mainnet,
  transport: http(),
})
```

:::

## Configuration Options

### PublicClientConfig

| Parameter | Type | Description |
|-----------|------|-------------|
| `Chain` | `*chain.Chain` | Chain configuration (optional) |
| `Transport` | `TransportFactory` | Transport to use for RPC calls |
| `Key` | `string` | Client identifier (default: "public") |
| `Name` | `string` | Client name (default: "Public Client") |
| `PollingInterval` | `time.Duration` | Polling frequency for subscriptions |
| `CacheTime` | `time.Duration` | Cache duration for repeated calls |
| `ExperimentalBlockTag` | `BlockTag` | Default block tag for calls |

## Available Methods

### Block Methods

:::code-group

```go [GetBlockNumber]
blockNumber, err := publicClient.GetBlockNumber(ctx)
// Returns: uint64
```

```go [GetBlock]
block, err := publicClient.GetBlock(ctx, client.BlockTagLatest, false)
// Returns: *types.Block
```

```go [GetBlockByNumber]
block, err := publicClient.GetBlockByNumber(ctx, 12345678, true) // with transactions
// Returns: *types.Block
```

```go [GetBlockByHash]
block, err := publicClient.GetBlockByHash(ctx, hash, false)
// Returns: *types.Block
```

:::

### Account Methods

:::code-group

```go [GetBalance]
balance, err := publicClient.GetBalance(ctx, address)
// Returns: *big.Int (wei)
```

```go [GetTransactionCount]
nonce, err := publicClient.GetTransactionCount(ctx, address)
// Returns: uint64
```

```go [GetCode]
code, err := publicClient.GetCode(ctx, contractAddress)
// Returns: []byte
```

```go [GetStorageAt]
value, err := publicClient.GetStorageAt(ctx, address, slot)
// Returns: []byte
```

:::

### Transaction Methods

:::code-group

```go [GetTransaction]
tx, err := publicClient.GetTransaction(ctx, txHash)
// Returns: json.RawMessage
```

```go [GetTransactionReceipt]
receipt, err := publicClient.GetTransactionReceipt(ctx, txHash)
// Returns: *types.Receipt
```

```go [WaitForTransactionReceipt]
receipt, err := publicClient.WaitForTransactionReceipt(ctx, txHash)
// Polls until transaction is mined
```

:::

### Call Methods

:::code-group

```go [Call]
result, err := publicClient.Call(ctx, types.CallRequest{
    To:   contractAddress,
    Data: calldata,
})
// Returns: []byte
```

```go [EstimateGas]
gas, err := publicClient.EstimateGas(ctx, types.CallRequest{
    From: sender,
    To:   recipient,
    Data: data,
})
// Returns: uint64
```

:::

### Fee Methods

:::code-group

```go [GetGasPrice]
gasPrice, err := publicClient.GetGasPrice(ctx)
// Returns: *big.Int
```

```go [GetMaxPriorityFeePerGas]
priorityFee, err := publicClient.GetMaxPriorityFeePerGas(ctx)
// Returns: *big.Int
```

```go [GetFeeHistory]
history, err := publicClient.GetFeeHistory(ctx, 10, client.BlockTagLatest, []float64{25, 50, 75})
// Returns: json.RawMessage
```

:::

### Chain Methods

:::code-group

```go [GetChainID]
chainID, err := publicClient.GetChainID(ctx)
// Returns: uint64
```

```go [GetLogs]
logs, err := publicClient.GetLogs(ctx, types.FilterQuery{
    FromBlock: big.NewInt(12345678),
    ToBlock:   big.NewInt(12345778),
    Addresses: []common.Address{contractAddress},
    Topics:    [][]common.Hash{{eventTopic}},
})
// Returns: []types.Log
```

:::

## Contract Interactions

The Public Client also supports contract read operations:

:::code-group

```go [Go]
result, err := publicClient.ReadContract(ctx, client.ReadContractOptions{
    Address:      common.HexToAddress("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"),
    ABI:          `[{"name":"balanceOf","type":"function","inputs":[{"name":"owner","type":"address"}],"outputs":[{"type":"uint256"}]}]`,
    FunctionName: "balanceOf",
    Args:         []any{ownerAddress},
})

balance := result.(*big.Int)
```

```typescript [TypeScript (viem)]
const balance = await publicClient.readContract({
  address: '0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48',
  abi: parseAbi(['function balanceOf(address) view returns (uint256)']),
  functionName: 'balanceOf',
  args: [ownerAddress],
})
```

:::

See [Reading Contracts](/docs/contract/read-contract) for more details.

## Block Tags

When querying state, you can specify which block to read from:

```go
const (
    BlockTagLatest    = "latest"    // Most recent mined block
    BlockTagPending   = "pending"   // Pending state
    BlockTagEarliest  = "earliest"  // Genesis block
    BlockTagSafe      = "safe"      // Safe head
    BlockTagFinalized = "finalized" // Finalized block
)

// Usage
balance, err := publicClient.GetBalance(ctx, address, client.BlockTagSafe)
```

## Error Handling

All methods return Go-style errors. RPC errors include additional context:

```go
balance, err := publicClient.GetBalance(ctx, address)
if err != nil {
    // Check if it's an RPC error
    var rpcErr *transport.RPCRequestError
    if errors.As(err, &rpcErr) {
        fmt.Printf("RPC Error %d: %s\n", rpcErr.Code, rpcErr.Message)
    }
    return err
}
```
