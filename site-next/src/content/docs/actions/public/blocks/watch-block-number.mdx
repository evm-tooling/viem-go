---
title: watchBlockNumber
description: Watches and returns incoming block numbers
---

# watchBlockNumber

Watches and returns incoming block numbers.

### Import

<CodeGroup
  tabs={[
    {
      title: "Go",
      language: "go",
      code: `import "github.com/ChefBingbong/viem-go/actions/public"`,
      showLineNumbers: false
    }
  ]}
/>

### Usage

Watch actions return a channel of events. Cancel the context to stop watching.

<CodeGroup
  tabs={[
    {
      title: "Go",
      language: "go",
      code: `import (
    "context"
    "fmt"
    "log"

    "github.com/ChefBingbong/viem-go/actions/public"
    "github.com/ChefBingbong/viem-go/client"
    "github.com/ChefBingbong/viem-go/client/transport"
    "github.com/ChefBingbong/viem-go/chain/definitions"
)

ctx, cancel := context.WithCancel(context.Background())
defer cancel()

publicClient, err := client.CreatePublicClient(client.PublicClientConfig{
    Chain:     definitions.Mainnet,
    Transport: transport.HTTP("https://eth.llamarpc.com"),
})
if err != nil {
    log.Fatal(err)
}
defer func() { _ = publicClient.Close() }()

events := public.WatchBlockNumber(ctx, publicClient, public.WatchBlockNumberParameters{}) // [!code focus]

for event := range events { // [!code focus:5]
    if event.Error != nil {
        log.Printf("error: %v", event.Error)
        continue
    }
    fmt.Printf("Block: %d\n", event.BlockNumber)
}`,
      showLineNumbers: false
    }
  ]}
/>

### Returns

`<-chan WatchBlockNumberEvent`

A channel that emits `WatchBlockNumberEvent` structs containing:
- `BlockNumber uint64` - The current block number
- `PrevBlockNumber *uint64` - The previous block number (nil for first event)
- `Error error` - Any error that occurred while fetching the block number

### Parameters

### EmitOnBegin (optional)

- **Type:** `bool`
- **Default:** `false`

Whether or not to emit the latest block number immediately when the watcher starts.

<CodeGroup
  tabs={[
    {
      title: "Go",
      language: "go",
      code: `events := public.WatchBlockNumber(ctx, publicClient, public.WatchBlockNumberParameters{
    EmitOnBegin: true, // [!code focus]
})`,
      showLineNumbers: false
    },
    {
      title: "viem",
      language: "ts",
      code: `const unwatch = publicClient.watchBlockNumber(
  { 
    emitOnBegin: true, // [!code focus]
    onBlockNumber: blockNumber => console.log(blockNumber),
  }
)`,
      showLineNumbers: false
    }
  ]}
/>

### EmitMissed (optional)

- **Type:** `bool`
- **Default:** `false`

Whether or not to emit missed block numbers to the channel.

Missed block numbers may occur in instances where internet connection is lost, or the block time is lesser than the [polling interval](/docs/clients/public#pollinginterval-optional) of the client.

<CodeGroup
  tabs={[
    {
      title: "Go",
      language: "go",
      code: `events := public.WatchBlockNumber(ctx, publicClient, public.WatchBlockNumberParameters{
    EmitMissed: true, // [!code focus]
})`,
      showLineNumbers: false
    },
    {
      title: "viem",
      language: "ts",
      code: `const unwatch = publicClient.watchBlockNumber(
  { 
    emitMissed: true, // [!code focus]
    onBlockNumber: blockNumber => console.log(blockNumber),
  }
)`,
      showLineNumbers: false
    }
  ]}
/>

### Poll (optional)

- **Type:** `*bool`
- **Default:** `false` for WebSocket Transports, `true` for non-WebSocket Transports

Whether or not to use a polling mechanism to check for new block numbers instead of a WebSocket subscription.

This option is only configurable for Clients with a [WebSocket Transport](/docs/clients/transports/websocket).

<CodeGroup
  tabs={[
    {
      title: "Go",
      language: "go",
      code: `poll := true
events := public.WatchBlockNumber(ctx, publicClient, public.WatchBlockNumberParameters{
    Poll: &poll, // [!code focus]
})`,
      showLineNumbers: false
    },
    {
      title: "viem",
      language: "ts",
      code: `const unwatch = publicClient.watchBlockNumber(
  { 
    poll: true, // [!code focus]
    onBlockNumber: blockNumber => console.log(blockNumber),
  }
)`,
      showLineNumbers: false
    }
  ]}
/>

### PollingInterval (optional)

- **Type:** `time.Duration`
- **Default:** Client's `PollingInterval`

The interval between polls when using polling mode.

<CodeGroup
  tabs={[
    {
      title: "Go",
      language: "go",
      code: `import "time"

events := public.WatchBlockNumber(ctx, publicClient, public.WatchBlockNumberParameters{
    PollingInterval: 5 * time.Second, // [!code focus]
})`,
      showLineNumbers: false
    },
    {
      title: "viem",
      language: "ts",
      code: `const unwatch = publicClient.watchBlockNumber(
  { 
    pollingInterval: 5_000, // [!code focus]
    onBlockNumber: blockNumber => console.log(blockNumber),
  }
)`,
      showLineNumbers: false
    }
  ]}
/>

### JSON-RPC Method

- When polling: calls [`eth_blockNumber`](https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_blocknumber) on a polling interval
- When subscribing: uses [`eth_subscribe`](https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_subscribe) with `"newHeads"` event
